---
title: "MSCS 150 Project"
author: "Bronwynn Woodsworth & Maxwell Rubin"
date: "1/19/2021"
output: pdf_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(gapminder)
library(tidyverse)
library(socviz)
library(dplyr)
library(ggrepel) # Library is required for geom_text_repel() ~SJL
theme_set(theme_gray())  # to keep the default plot background as gray
```


```{r}
cereal <- read.csv(file = "/home/rstudio/courses/2020-21-interim-mscs-150/Class/Data/cereal.csv")
cereal <- as_tibble(cereal)
cereal
```

```{r}
str(cereal)
```

```{r fig.height=10}
# GRAPH 1
# PLOT OF SUGAR CONTENT OF EACH CEREAL, COLORED BY MANUFACTURER
# NOT PART OF THE FINAL PRESENTATION
p <- ggplot(data = cereal, mapping = aes(x = reorder(name, sugars), y = sugars, color = mfr))
p + geom_point() + coord_flip() +
  labs(x = "Cereal name",
       y = "Sugar (in grams)",
       title = "Sugar content by cereal name",
       subtitle = "Colored by manufacturer",
       color = "Manufacturer")
```

```{r}
# PIPE TO FIND MEAN AND SD OF ALL NUMERIC VARIABLES
mean_df <- 
  cereal %>%
  group_by(mfr) %>%
  summarize_if(is.numeric, 
                 list(~ mean(., na.rm = TRUE), 
                      ~ sd(., na.rm = TRUE))) 
mean_df
```

```{r}
#GRAPH 2
# PLOT MEAN SUGAR PER MANUFACTURER - COLORFUL COLUMN PLOT
p <- ggplot(data = mean_df, mapping = aes(x = reorder(mfr, sugars_mean), y = sugars_mean, fill = mfr))

p + geom_col() +
  labs(x = "Manufacturer",
       y = "Mean sugar content (in grams)",
       title = "Mean sugar content per manufacturer",
       subtitle = "Color by manufacturer",
       color = "Manufacturer")
```

```{r}
# GRAPH 3
# BOXPLOT OF SUGAR CONTENT PER MANUFACTURER
p <- ggplot(data = cereal, mapping = aes(x = mfr, y = sugars, color = mfr, fill = "orange"))
p + geom_boxplot() +
  guides(fill = FALSE) +
  labs(x = "Manufacturer",
       y = "Sugar (in grams)",
       title = "Sugar content v. Manufacturer",
       subtitle = "Color by manufacturer",
       color = "Manufacturer")
```


#cannot add a line or smooth
```{r}
# GRAPH 4
# CEREAL MANUFACTURER RATING MEAN v. MEAN SUGAR CONTENT of CEREAL
mean_df
p <- ggplot(data = mean_df, mapping = aes(x = sugars_mean, y = rating_mean, color = mfr))

p + geom_point(alpha = 1, size = 4) + 
  geom_text_repel(aes(label = mfr)) +
  labs(x = "Manufacturer Sugar Mean", 
       y = "Manufacturer's Rating Mean", 
       title = "Cereal Manufacturer Sugar Content v. Cereal Manufacturer Rating Mean") + 
  theme(legend.position = "right")
```


```{r}
# GRAPH 5
# GRID OF MANUFACTURERS AND SUGAR CONTENT OF EACH CEREAL
p <- ggplot(data = cereal, mapping = aes(x = sugars, y = rating))
p + geom_point(alpha = 0.3) + 
  facet_wrap(~ mfr) + 
  geom_jitter(position = position_jitter(width = 2, height = 2), aes(color = factor(mfr))) +
  theme(strip.background = element_rect(fill = "orange")) + 
  guides(fill = FALSE) +
  labs(x = "Sugar (in grams)",
       y = "Rating",
       title = "Sugar content v. Cereal rating",
       subtitle = "Faceted by manufacturer and jittered by 2 (width, height)",
       color = "Manufacturer")
```


```{r}
# GRAPH 6
# PLOT OF ALL KELLOGG CEREAL SUGAR CONTENT
kellogg <- c("K")
kellogg

p <- ggplot(data = subset(cereal, subset = mfr %in% kellogg), aes(x = name, y = sugars))
p + geom_point() + 
  coord_flip() +
  labs(y = "Sugar content (in grams)",
       x = "Cereal name",
       title = "Kellogg - sugar content by cereal")
```

```{r}
# GRAPH 7
# PLOT OF POSITION ON DISPLAY SHELF VS. SUGAR CONTENT
# avg position on shelf per manf 
cereal

mean_ss <- 
  cereal %>%
  group_by(shelf, sugars) %>%
  summarize_if(is.numeric, 
                 list(~ mean(., na.rm = TRUE), 
                      ~ sd(., na.rm = TRUE))) 
mean_ss

p <- ggplot(data = cereal, mapping = aes(x = mfr, y = shelf))
p + geom_point(aes(color = shelf, size = 3)) + theme(legend.position = "none") +
  labs(x = "Manufacturer", y = "Shelf", title = "Shelf Placement for each Manufacturer")
```

```{r}
#TRIAL What is this pipe?
mean_ss <- 
  cereal %>%
  group_by(shelf, sugars) %>%
  summarize_if(is.numeric, 
                 list(~ mean(., na.rm = TRUE), 
                      ~ sd(., na.rm = TRUE))) 
mean_ss

p <- ggplot(data = mean_ss, mapping = aes(x = , y = shelf))
p + geom_point(aes(color = shelf, size = 3)) + theme(legend.position = "none") +
  labs(x = "Manufacturer", y = "Shelf", title = "Shelf Placement for each Manufacturer")
```



```{r}

#cereal
#x is originally sugars
#CANNOT PLOT A RATING GRAPH WHEHN I MADE A PIPE

p <- ggplot(data = cereal, mapping = aes(x = sugars, y = shelf))
p + geom_point(alpha = 0.3) + 
  facet_wrap(~ mfr) + 
  theme(strip.background = element_rect(fill = "orange")) + 
  guides(fill = FALSE) +
  labs(x = "Sugar (in grams)",
       y = "Shelf",
       title = "Sugar content v. Shelf Level",
       subtitle = "Faceted by manufacturer and jittered by 2 (width, height)",
       color = "Manufacturer")

sugar_shelf <- 
  cereal %>%
  group_by(sugars, shelf) %>%
  summarize(N = n()) # Removed pipe symbol here ~SJL
sugar_shelf

#shelf rating pipe
shelf_rating <-
  cereal %>%
  group_by(shelf, rating) %>%
  summarize(N = n())
shelf_rating

#shelf rating plot
p <- ggplot(data = cereal, mapping = aes(x = rating, y = shelf))
p + geom_point(alpha = 0.3) + 
  facet_wrap(~ mfr) +
    theme(strip.background = element_rect(fill = "orange")) +
     labs(x = "Cereal Rating",
       y = "Shelf Level",
       title = "Cereal Rating v. Shelf Level",
       color = "Manufacturer")

class(cereal$shelf)
class(cereal$sugars)

summary(cereal$shelf)
summary(cereal$sugars)
```
```{r}
# Maxwell's plot (sugar/shelf/manufacturer + colored by rating)
p <- ggplot(data = cereal, mapping = aes(x = sugars, y = shelf, color = rating))

p + geom_point(alpha = 0.5, size = 2) + 
  facet_wrap(~ mfr) + 
  theme(strip.background = element_rect(fill = "orange")) + 
  guides(fill = FALSE) +
  labs(x = "Sugar (in grams)",
       y = "Shelf",
       title = "Sugar content v. Shelf Level",
       subtitle = "Faceted by manufacturer, colored by rating",
       color = "Rating")
```

